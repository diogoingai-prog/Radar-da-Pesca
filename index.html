<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Radar da Pesca üì°</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root { --accent:#38bdf8; --bg:#0f172a; --card:#fff; --status-red:#dc2626; --badge-green:#10b981; }
    * { box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html, body, #map { height:100%; margin:0; overflow:hidden; }
    body { font-family: "Inter", sans-serif; background: var(--bg); }

    /* SPLASH SCREEN */
    #splash { position: fixed; inset:0; background: var(--bg); z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; transition: opacity 0.5s; }
    .radar-container{ position:relative; width:220px; height:220px; }
    .radar-rings circle{ fill:none; stroke:rgba(56,189,248,.15); stroke-width:1; }
    .radar-scan-line{ transform-origin:100px 100px; animation: scan-anim 4s linear infinite; }
    @keyframes scan-anim{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
    .splash-title{ color:#fff; font-size:24px; font-weight:900; letter-spacing:3px; margin-top:20px; }

    /* UI ELEMENTS */
    .gps-btn { position:absolute; bottom:250px; right:20px; z-index:2500; background:#fff; width:54px; height:54px; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 12px rgba(0,0,0,0.2); border:none; color:#1d4ed8; cursor:pointer; }
    
    .drawer { position:absolute; bottom:0; left:0; right:0; z-index:2000; background:#fff; border-radius:24px 24px 0 0; height:230px; transition: height 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); display:flex; flex-direction:column; }
    .drawer.open { height:85vh; }
    .handle { height:35px; width:100%; display:flex; align-items:center; justify-content:center; cursor:pointer; }
    .handle-bar { width:40px; height:5px; background:#e2e8f0; border-radius:10px; }

    .summary { padding:0 20px 20px; }
    .city-label { font-size:20px; font-weight:800; margin:5px 0; color:#0f172a; }
    .env-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:15px; }
    .env-box { background:#f8fafc; padding:10px; border-radius:12px; text-align:center; border:1px solid #e2e8f0; }
    .env-lbl { display:block; font-size:9px; font-weight:800; color:#64748b; text-transform:uppercase; }
    .env-val { font-size:13px; font-weight:800; color:#0f172a; }
  </style>
</head>
<body>

  <div id="splash">
    <div class="radar-container">
      <svg viewBox="0 0 200 200" width="200" height="200">
        <g class="radar-rings"><circle cx="100" cy="100" r="98"/><circle cx="100" cy="100" r="70"/><circle cx="100" cy="100" r="40"/></g>
        <g class="radar-scan-line"><path d="M 100 100 L 100 0 A 100 100 0 0 1 200 100 Z" fill="rgba(56, 189, 248, 0.3)"/></g>
      </svg>
    </div>
    <h1 class="splash-title">RADAR DA PESCA</h1>
  </div>

  <div id="map"></div>

  <button id="gps-btn" class="gps-btn"><span class="material-icons">my_location</span></button>

  <section id="painel" class="drawer">
    <div class="handle" id="drawer-handle"><div class="handle-bar"></div></div>
    <div class="summary">
      <h2 class="city-label" id="lbl-cidade">üìç Localizando...</h2>
      <div class="env-grid">
        <div class="env-box"><span class="env-lbl">Temp</span><span class="env-val" id="val-temp">--</span></div>
        <div class="env-box"><span class="env-lbl">Vento</span><span class="env-val" id="val-vento">--</span></div>
        <div class="env-box"><span class="env-lbl">Lua</span><span class="env-val" id="val-lua">--</span></div>
        <div class="env-box"><span class="env-lbl">Press√£o</span><span class="env-val" id="val-press">--</span></div>
        <div class="env-box"><span class="env-lbl">Chuva</span><span class="env-val" id="val-rain">--</span></div>
        <div class="env-box"><span class="env-lbl">Humid.</span><span class="env-val" id="val-hum">--</span></div>
      </div>
    </div>
  </section>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    // 1. Inicializa√ß√£o do Mapa
    const map = L.map('map', { zoomControl: false }).setView([-15.7938, -47.8827], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    // 2. Controle do Drawer (Painel)
    const drawer = document.getElementById('painel');
    document.getElementById('drawer-handle').addEventListener('click', () => {
      drawer.classList.toggle('open');
    });

    // 3. Fun√ß√£o de Localiza√ß√£o Real
    const gpsBtn = document.getElementById('gps-btn');
    gpsBtn.addEventListener('click', () => {
      if ("geolocation" in navigator) {
        gpsBtn.style.color = "#38bdf8";
        navigator.geolocation.getCurrentPosition((position) => {
          const { latitude, longitude } = position.coords;
          map.setView([latitude, longitude], 13);
          
          // Simula atualiza√ß√£o de dados ao encontrar local
          document.getElementById('lbl-cidade').textContent = `üìç Localiza√ß√£o Atual`;
          document.getElementById('val-temp').textContent = '26¬∞C';
          document.getElementById('val-vento').textContent = '12km/h';
          document.getElementById('val-lua').textContent = 'Crescente';
          
          L.marker([latitude, longitude]).addTo(map)
            .bindPopup('Voc√™ est√° aqui para pescar!').openPopup();
          
          gpsBtn.style.color = "#1d4ed8";
        }, () => {
          alert("Erro ao obter localiza√ß√£o. Verifique as permiss√µes.");
        });
      }
    });

    // 4. Remover Splash Screen ap√≥s carregar
    window.addEventListener('load', () => {
      setTimeout(() => {
        document.getElementById('splash').style.opacity = '0';
        setTimeout(() => document.getElementById('splash').remove(), 500);
      }, 2000);
    });
  </script>
</body>
</html>
